<!DOCTYPE html>
<html>
<head>
    <title>Оплата через СБП</title>
    <style>
        body { font-family: Arial; padding: 20px; text-align: center; }
        .qr { margin: 20px; }
        .status { margin-top: 20px; font-size: 18px; }
    </style>
</head>
<body>
    <h1>Оплата через СБП</h1>
    <p>Сумма: <span id="amount">100</span> ₽</p>
    <div class="qr">
        <img id="qr-image" src="" alt="QR-код для оплаты">
    </div>
    <div class="status" id="status">Ожидаем оплату...</div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id');
        const amount = urlParams.get('amount') || '100';

        fetch(`https://yourserver.com/create_sbp_invoice?user_id=${userId}&amount=${amount}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('qr-image').src = data.qr_url;
                document.getElementById('amount').textContent = data.amount;

                const checkStatus = () => {
                    fetch(`https://yourserver.com/check_sbp_status?invoice_id=${data.invoice_id}`)
                        .then(response => response.json())
                        .then(status => {
                            if (status.paid) {
                                document.getElementById('status').textContent = '✅ Оплачено!';
                                setTimeout(() => {
                                    window.location.href = 'https://t.me/yourbot?start=payment_success_' + userId;
                                }, 2000);
                            } else {
                                setTimeout(checkStatus, 5000);
                            }
                        });
                };
                checkStatus();
            });
    </script>
</body>
</html>
